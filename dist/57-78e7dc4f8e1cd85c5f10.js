webpackJsonp([57],{126:function(e,t){e.exports={postBlock:"postBlock___289N6",deletedPost:"deletedPost___29jEr",marginLeft10:"marginLeft10___187xh",checkDiv:"checkDiv___32MNn",radioAndCheck:"radioAndCheck___1BDvU",postContent:"postContent___2wa8u",postInfo:"postInfo___2AFM9",content:"content___2jS2O",listPicture:"listPicture___2iS2s",addPostTip:"addPostTip___1hiRw"}},917:function(e,t,l){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,n,o,u=(l(50),l(41)),r=a(u),d=(l(46),l(42)),s=a(d),c=(l(70),l(69)),f=a(c),p=(l(297),l(296)),m=a(p),h=(l(11),l(10)),v=a(h),E=(l(128),l(58)),y=a(E),g=(l(17),l(19)),_=a(g),b=(l(414),l(413)),C=a(b),I=l(3),k=a(I),w=(l(72),l(71)),x=a(w),V=l(4),T=a(V),z=l(6),F=a(z),L=l(5),P=a(L),A=(l(25),l(24)),M=a(A),U=l(1),D=a(U),R=l(16),B=l(126),N=(a(B),l(78)),S=a(N),q=l(176),O=l(14),H=a(O),Y=l(526),j=(i=(0,R.connect)(function(e){var t=e.activity;return{activity:t}}),n=M.default.create({}),i(o=n(o=function(e){function t(){(0,T.default)(this,t);for(var l=arguments.length,a=Array(l),i=0;i<l;i++)a[i]=arguments[i];var n=(0,F.default)(this,e.call.apply(e,[this].concat(a)));return n.id="",n}return(0,P.default)(t,e),t.prototype.submit=function(e){var t=this;e.preventDefault();var l=this.props,a=l.dispatch,i=l.form;i.validateFields(function(e,l){e||(l.cover=l.cover[l.cover.length-1].url,l.cover=l.cover.replace(/http\:\/\/(.*?)\//,"/"),t.id?(l.id=t.id,a({type:"activity/updateTopic",payload:{body:l,id:t.id}})):a({type:"activity/createTopic",payload:{body:l}}))})},t.prototype.addBook=function(){},t.prototype.preview=function(){var e=this.props.form.getFieldValue("content"),t=this.props.form.getFieldValue("title");if(e){var l={display:"inline-block",verticalAlign:"top"};x.default.info({title:D.default.createElement("h1",null,t||"\u8bdd\u9898"),width:1e3,maskClosable:!0,content:D.default.createElement("div",null,e.split("\n").map(function(e){if(!new RegExp(/{{.*?}}/).test(e))return D.default.createElement("div",{style:{fontSize:"1.4em"}},e);var t={};if(e.replace(/\{|\}/g,"").split(",").map(function(e){t[e.split(":")[0]]=e.split(":")[1]}),"image"===t.type){var a=Number(t.size&&t.size.split("-")[0]||600),i=Number(t.size&&t.size.split("-")[1]||800);return t.url=decodeURIComponent(t.url)+"?imageView/2/w/"+a+"/h/"+i,D.default.createElement("img",{style:{maxWidth:"100%"},src:t.url})}return"book"===t.type?D.default.createElement("div",{style:{margin:"10px 0"}},D.default.createElement("img",{src:decodeURIComponent(t.cover),style:(0,k.default)({},l,{width:"80px"})}),D.default.createElement("div",{style:(0,k.default)({},l,{marginLeft:"10px"})},D.default.createElement("h2",null,t.title),D.default.createElement("div",null,t.author))):void 0}))})}},t.prototype.componentWillMount=function(){var e=this.props,t=e.dispatch,l=e.location;this.id=l.query.id||"",this.id&&t({type:"activity/getTopic",payload:this.id})},t.prototype.getCoverUpload=function(e){return e&&e.fileList&&0!==e.fileList.length?(e.fileList.forEach(function(e){return e.url=e.response&&e.response.url}),e.fileList):[]},t.prototype.render=function(){var e=this,t={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:14,offset:1}}},l={name:"postfile",action:S.default.url+"posts/image/upload",showUploadList:!1,headers:{Authorization:q.accountCache.get()?q.accountCache.get().token:null},onChange:function(t){var l=e;if("done"===t.file.status){var a=t.file.response.url,i=new Image;i.src=a,i.onload=function(){var e="{{type:image,url:"+encodeURIComponent(a)+",size:"+this.width+"-"+this.height+"}}",t=l.props.form;t.setFieldsValue({content:(t.getFieldValue("content")||"")+"\n"+e})}}}},a={name:"postfile",action:S.default.url+"posts/image/upload",headers:{Authorization:q.accountCache.get()?q.accountCache.get().token:null}},i={dispatch:this.props.dispatch,location:this.props.location,onOk:function(t){console.log(t);var l="";t.forEach(function(e){return l+="{{type:book,id:"+e._id+",title:"+e.title+",author:"+e.author+",cover:"+encodeURIComponent("https://statics.zhuishushenqi.com"+e.cover)+"}}\n"});var a=e.props.form;a.setFieldsValue({content:(a.getFieldValue("content")||"")+"\n"+l})}},n=this.props.form.getFieldDecorator,o=this.props.activity.topicInfo;return D.default.createElement("div",null,D.default.createElement(C.default,{style:{marginBottom:"10px"}},D.default.createElement(C.default.Item,null,"Home"),D.default.createElement(C.default.Item,null,D.default.createElement("a",{href:"#/activities/special-topic"},"\u4e13\u9898\u5217\u8868")),D.default.createElement(C.default.Item,null,"\u4e13\u9898\u7f16\u8f91")),D.default.createElement("div",{className:"content-inner"},D.default.createElement(M.default,{onSubmit:this.submit.bind(this)},D.default.createElement(M.default.Item,(0,k.default)({},t,{label:"\u4e13\u9898\u6807\u9898"}),n("title",{initialValue:o.title||"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4e13\u9898\u6807\u9898"}]})(D.default.createElement(_.default,null))),D.default.createElement(M.default.Item,(0,k.default)({},t,{label:"\u4e13\u9898\u7f16\u53f7"}),n("order",{initialValue:o.order||"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4e13\u9898\u7f16\u53f7"}]})(D.default.createElement(_.default,null))),D.default.createElement(M.default.Item,(0,k.default)({},t,{label:"\u5c01\u9762"}),n("cover",{valuePropName:"fileList",initialValue:o.cover&&[{url:S.default.staticsHost+o.cover,name:"cover",uid:o.cover,status:"done"}],getValueFromEvent:this.getCoverUpload.bind(this),rules:[{required:!0,message:"\u8bf7\u4e0a\u4f20\u5c01\u9762\uff01"}]})(D.default.createElement(m.default,a,D.default.createElement(v.default,null,D.default.createElement(y.default,{type:"upload"}),"\u4e0a\u4f20\u5c01\u9762")))),D.default.createElement(M.default.Item,(0,k.default)({},t,{label:"\u4e13\u9898\u526f\u6807\u9898"}),n("subtitle",{initialValue:o.subtitle||""})(D.default.createElement(_.default,null))),D.default.createElement(M.default.Item,(0,k.default)({},t,{label:"\u5b9a\u65f6\u53d1\u9001"}),n("scheduleTime",{initialValue:o.scheduleTime?(0,H.default)(o.scheduleTime):null})(D.default.createElement(f.default,{style:{width:"170px"},showTime:!0,format:"YYYY-MM-DD HH:mm:ss",placeholder:"Select Time"}))),D.default.createElement(M.default.Item,(0,k.default)({},t,{label:"\u6240\u5c5eAPP"}),n("app",{initialValue:o.app||""})(D.default.createElement(s.default,null,D.default.createElement(s.default.Option,{value:"mose"},"\u58a8\u8272"),D.default.createElement(s.default.Option,{value:"doukou"},"\u8c46\u853b")))),D.default.createElement(M.default.Item,(0,k.default)({},t,{label:"\u6240\u5c5e\u5e73\u53f0"}),n("platforms",{initialValue:o.platforms||[]})(D.default.createElement(r.default.Group,{options:["android","ios"]}))),D.default.createElement(M.default.Item,(0,k.default)({},t,{label:"\u5185\u5bb9"}),n("content",{initialValue:o.content})(D.default.createElement(_.default,{type:"textarea",rows:10})),D.default.createElement("div",null,D.default.createElement(m.default,(0,k.default)({},l,{style:{marginRight:"5px"}}),D.default.createElement(v.default,null,"\u4e0a\u4f20\u56fe\u7247")),D.default.createElement(Y.BooksSearchModal,(0,k.default)({},i,{item:{}}),"\u6dfb\u52a0\u4e66\u7c4d"),D.default.createElement(v.default,{onClick:this.preview.bind(this),style:{marginLeft:"5px"}},"\u9884\u89c8"))),D.default.createElement(M.default.Item,{wrapperCol:{xs:{span:24,offset:0},sm:{span:14,offset:7}}},D.default.createElement(v.default,{type:"primary",htmlType:"submit",size:"large"},this.id?"\u66f4\u65b0":"\u6dfb\u52a0")))))},t}(D.default.Component))||o)||o);t.default=j,e.exports=t.default}});